---
title: Android 工程师进阶学习笔记
renderNumberedHeading: true
grammar_cjkRuby: true
---
# 第二讲
JVM 垃圾回收依据：
通过可达性分析，确定内存中的对象是否为垃圾，如果与 `GC Root` 没有直接或间距的联系，即一个对象无法通过引用关系连线到`GC Root`那么他将会被当做 GC 垃圾

在 Java 中，有以下几种对象可以作为 GC Root：
- Java 虚拟机栈（局部变量表）中的引用的对象。
- 方法区中静态引用指向的对象。
- 仍处于存活状态中的线程对象。
- Native 方法中 JNI 引用的对象。
 
常见 JVM 垃圾回收算法:
- 标记清除法
  1、遍历标记存活对象与垃圾对象
  2、清除标记的垃圾对象
  优点：实现简单，不需要移动对象
  缺点：需要暂停其他进程，频繁回收会造成卡顿。回收后内存不连续，会提高回收频率
- 复制算法
  1、将内存分为两部分，每次只使用其中的一部分。
  2、回收内存遍历标记存活对象与垃圾对象
  3、将存活对象复制到空闲的一半内存中
  优点:内存连续，效率高
  缺点:每次只能使用一半的内存，高存活率对象会不断复制
- 标记压缩法
  1、标记存活对象与垃圾对象
  2、回收垃圾对象
  3、压缩存活对象
  优点:内存连续，也不需要内存分半使用。性价比较高
  缺点:压缩过程会降低效率
# 第六讲
 Class 对象在执行引擎中的初始化过程：
 装载-->链接(验证、准备、解析)-->初始化 

主要分 3 大步：装载、链接、初始化。其中链接中又包含验证、准备、解析 3 小步。

- 装载：指查找字节流，并根据此字节流创建类的过程。装载过程成功的标志就是在方法区中成功创建了类所对应的 Class 对象。

- 链接：指验证创建的类，并将其解析到 JVM 中使之能够被 JVM 执行。
  1、验证：`文件格式检`验校验加载的字节流是否符合 JVM 的规范,`元数据检验`对字节码描述的信息进行语义分析，以保证其描述的内容符合 Java 语言规范的要求。`字节码检验`通过数据流和控制流分析，确定程序语义是合法、符合逻辑的。`符号引用检验`符号引用检验可以看作是对类自身以外（常量池中的各种符号引用）的信息进行匹配性校验。
  2、准备：为类中的静态变量分配内存。静态变值此时为默认值，静态常量此时会被赋值。
  3、解析：将常量池中的符号引用转化为内存中实际的对象，与内存中真实的对象关联起来。

- 初始化：则是将标记为 static 的字段进行赋值，并且执行 static 标记的代码语句 。
初始化过程会为对象赋值。

***触发 Class 初始化的时机：***
1、虚拟机启动时，初始化包含 main 方法的主类；

2、遇到 new 指令创建对象实例时，如果目标对象类没有被初始化则进行初始化操作；

3、当遇到访问静态方法或者静态字段的指令时，如果目标对象类没有被初始化则进行初始化操作；

4、子类的初始化过程如果发现其父类还没有进行过初始化，则需要先触发其父类的初始化；

5、使用反射 API 进行反射调用时，如果类没有进行过初始化则需要先触发其初始化；

6、第一次调用 java.lang.invoke.MethodHandle 实例时，需要初始化 MethodHandle 指向方法所在的类。

# 第七讲
