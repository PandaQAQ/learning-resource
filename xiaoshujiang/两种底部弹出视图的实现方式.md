---
title: 两种底部弹出视图的实现方式 
---
当应用在进行一些选择操作时，使用从屏幕底部弹出选择菜单。再配合动画效果能带来不错的交互体验，譬如说在选择照片时弹出的照片列表或者分享操作时弹出的选择分享应用。这类选项较多的应用场景从底部弹出的效果都比直接弹出一个 Dialog 弹窗要来的顺畅。今天将介绍底部视图弹出的两种实现方式。

![BottomMenu][1]
# PopupWindow 方式
PopupWindow 是我们在实现各种弹窗效果时第一反应最容易想到的方式。但是使用 PopupWindow 的方式需要自己添加一些过渡动画吗，以避免弹出和隐藏的太突兀。接下来看具体代码：
``` java
    private void initPopupWindow() {
        View view = LayoutInflater.from(this).inflate(R.layout.dialog_bottom_sheet, null, false);
        mPopupWindow = new PopupWindow(view, ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT);
        mPopupWindow.setContentView(view);
        mPopupWindow.setBackgroundDrawable(new BitmapDrawable());
        mPopupWindow.setOutsideTouchable(true);
        //以上代码已经能够实现 popup 的弹出效果，但是为了体验更好应该添加动画
        mPopupWindow.setAnimationStyle(R.style.BottomPopupWindow);
        mPopupWindow.setOnDismissListener(new PopupWindow.OnDismissListener() {
            @Override
            public void onDismiss() {
                backgroundAlpha(1f);
            }
        });
    }
	
	.
	.
	.
	// 点击显示 popup
            case R.id.tv_popup:
                if (mPopupWindow == null) {
                    return;
                }
                mPopupWindow.setFocusable(true);
                if (!mPopupWindow.isShowing()) {
                    int[] location = new int[2];
                    mRlParent.getLocationOnScreen(location);
                    mPopupWindow.showAtLocation(mRlParent, Gravity.START | Gravity.BOTTOM, 0, -location[1]);
                    backgroundAlpha(0.5f);
                } else {
                    mPopupWindow.dismiss();
                }
                break;
```
重点关注：`mPopupWindow.setAnimationStyle(R.style.BottomPopupWindow);` 和点击显示部分的代码。先看 setAnimationStyle() 部分，这个方法将 style 中为 PopupWindow 定义的显示和隐藏动画与 PopupWindow 进行了绑定
``` xml
    <style name="BottomPopupWindow">
        <item name="android:windowEnterAnimation">@anim/popup_in</item>
        <item name="android:windowExitAnimation">@anim/popup_out</item>
    </style>
```
popup_in 中的代码，popup_out 与之相反
``` xml
<translate
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:duration="300"
    android:fromYDelta="100%"
    android:interpolator="@android:anim/accelerate_interpolator"
    android:toYDelta="0"/>
``` 
上面的 popup 展开与隐藏动画都是最基础的 translate 动画，实现的效果即开篇的 GIF 中的向上展开和向下隐藏效果。
# BottomSheetDialog 方式
BottomSheetDialog 是 android.support.design.widget 包中的一个控件类，可以直接使用然后填充自己的布局进去即可，也可以继承然后做一些自定义。


  [1]: http://oddbiem8l.bkt.clouddn.com/BottomMenu.gif